<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Work Pro Israel - Classic Layout</title>
    <style>
        :root { --bg: #f0f2f5; --card-bg: #ffffff; --primary: #4e73df; --success: #1cc88a; --danger: #e74a3b; --text-main: #2e3440; --text-sub: #858796; --ot-purple: #6f42c1; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: var(--text-main); margin: 0; padding: 20px 15px; }
        .container { max-width: 480px; margin: 0 auto; }
        .card { background: var(--card-bg); border-radius: 18px; padding: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.04); margin-bottom: 15px; border: 1px solid rgba(0,0,0,0.02); }
        .card-title { font-size: 0.75rem; font-weight: 800; color: var(--text-sub); text-transform: uppercase; margin-bottom: 12px; display: block; letter-spacing: 0.5px; }
        input { background: #f8f9fc; border: 1px solid #d1d3e2; padding: 12px; border-radius: 10px; width: 100%; box-sizing: border-box; font-size: 1rem; margin-bottom: 10px; }
        .timer-display { font-size: 3.2rem; font-weight: 800; text-align: center; margin: 15px 0; color: var(--primary); font-family: monospace; }
        .btn { padding: 16px; border: none; border-radius: 12px; font-weight: 700; width: 100%; cursor: pointer; margin-bottom: 10px; transition: 0.2s; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-outline { background: none; border: 1px solid var(--text-sub); color: var(--text-sub); padding: 10px; font-size: 0.8rem; border-radius: 10px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; font-size: 0.7rem; color: var(--text-sub); padding: 10px; border-bottom: 1px solid #eaecf4; }
        td { padding: 12px 10px; font-size: 0.85rem; border-bottom: 1px solid #f8f9fc; }
        
        /* ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
        .summary-card { background: linear-gradient(135deg, #1a1c23, #2d3436); color: white; padding: 25px; border-radius: 22px; text-align: center; margin-top: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .net-label { opacity: 0.7; font-size: 0.9rem; display: block; }
        .net-amount { font-size: 3rem; font-weight: 800; color: #00ff88; display: block; margin: 5px 0; }
        .sat-text { color: var(--danger); font-size: 0.6rem; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="card" style="border-left: 5px solid var(--primary);">
        <span class="card-title">üìÖ ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
        <input type="month" id="monthFilter" onchange="renderData()">
    </div>

    <div class="card">
        <span class="card-title">üïí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
        <input type="date" id="currentDate">
        <div class="timer-display" id="timerDisplay">00:00:00</div>
        <button id="startBtn" class="btn btn-success" onclick="startWork()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
        <button id="endBtn" class="btn btn-danger" style="display:none;" onclick="endWork()">‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô (‡∏´‡∏±‡∏Å‡∏û‡∏±‡∏Å 30‡∏ô.)</button>
    </div>

    <div class="card" style="background:#fdfdfd; border: 1px dashed #d1d3e2;">
        <span class="card-title">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</span>
        <input type="date" id="manualDate">
        <div class="grid-2">
            <div><label style="font-size:0.6rem;">‡πÄ‡∏£‡∏¥‡πà‡∏°</label><input type="time" id="timeIn" value="06:00"></div>
            <div><label style="font-size:0.6rem;">‡πÄ‡∏•‡∏¥‡∏Å</label><input type="time" id="timeOut" value="17:00"></div>
        </div>
        <label style="font-size:0.6rem;">‡∏´‡∏±‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏±‡∏Å (‡∏ä‡∏°.)</label>
        <input type="number" id="manualBreak" value="0.5" step="0.1">
        <button class="btn btn-primary" onclick="saveManual()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>

    <div class="card">
        <span class="card-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
        <div class="grid-2">
            <div><label style="font-size: 0.65rem;">‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á/‡∏ä‡∏°.</label><input type="number" id="rate" value="38" oninput="renderData()"></div>
            <div><label style="font-size: 0.65rem;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏£‡∏¥‡∏°</label><input type="number" id="bonus" value="0" oninput="renderData()"></div>
        </div>
        <label style="font-size: 0.65rem;">‡∏¢‡∏≠‡∏î‡∏´‡∏±‡∏Å‡∏£‡∏ß‡∏° (‡∏†‡∏≤‡∏©‡∏µ/‡∏ô‡πâ‡∏≥‡πÑ‡∏ü)</label>
        <input type="number" id="totalDeduction" value="0" oninput="renderData()">
    </div>

    <div class="card" style="padding: 10px; overflow-x: auto;">
        <span class="card-title" style="padding: 10px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</span>
        <table>
            <thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ä‡∏°.</th><th>‡∏õ‡∏Å‡∏ï‡∏¥</th><th>‡πÇ‡∏≠‡∏ó‡∏µ</th><th>‡∏£‡∏ß‡∏°</th><th></th></tr></thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>

    <div class="summary-card">
        <span class="net-label">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
        <span class="net-amount">‚Ç™ <span id="netDisplay">0</span></span>
        <div style="display: flex; justify-content: space-around; font-size: 0.8rem; opacity: 0.9; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; margin-bottom: 10px;">
            <div>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏£‡∏ß‡∏°: <b id="totalHDisplay">0</b></div>
            <div>‡∏¢‡∏≠‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏±‡∏Å: <b id="grossDisplay">0</b></div>
        </div>
        <button onclick="copySummary()" style="background:rgba(255,255,255,0.1); border:none; color:white; padding:8px 15px; border-radius:8px; font-size:0.75rem; cursor:pointer; width:100%;">üìã ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏™‡πà‡∏á LINE</button>
    </div>

    <div class="grid-2" style="margin-top: 15px;">
        <button onclick="backupData()" class="btn-outline">üì• ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏•‡∏á Note</button>
        <button onclick="restoreData()" class="btn-outline">üì§ ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>
    
    <button onclick="clearSystem()" style="width:100%; background:none; color:#ccc; border:none; padding: 20px; font-size: 0.7rem;">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
</div>

<script>
    const now = new Date();
    document.getElementById('monthFilter').value = now.toISOString().substring(0, 7);
    document.getElementById('currentDate').value = now.toISOString().split('T')[0];
    document.getElementById('manualDate').value = now.toISOString().split('T')[0];

    let workData = JSON.parse(localStorage.getItem('work_data_v2') || "{}");
    let timerInterval, startTime = null;

    function renderData() {
        const tbody = document.getElementById('tableBody');
        const rate = parseFloat(document.getElementById('rate').value) || 0;
        const bonus = parseFloat(document.getElementById('bonus').value) || 0;
        const deduct = parseFloat(document.getElementById('totalDeduction').value) || 0;
        const selectedMonth = document.getElementById('monthFilter').value;
        let sumH = 0, totalGross = 0;
        tbody.innerHTML = "";

        Object.keys(workData).sort().reverse().forEach(date => {
            if (date.startsWith(selectedMonth)) {
                const h = parseFloat(workData[date]);
                const isSat = new Date(date).getDay() === 6;
                let np = 0, op = 0;
                if (isSat) { 
                    np = Math.min(8, h) * rate * 1.5; 
                    op = Math.max(0, h-8) * rate * 1.75; 
                } else { 
                    np = Math.min(8, h) * rate; 
                    op = (Math.max(0, Math.min(2, h-8)) * rate * 1.25) + (Math.max(0, h-10) * rate * 1.5); 
                }
                sumH += h; totalGross += (np + op);
                tbody.innerHTML += `<tr><td>${date.split('-')[2]}/${date.split('-')[1]} ${isSat?'<br><span class="sat-text">SAT</span>':''}</td><td style="font-weight:700;">${h.toFixed(2)}</td><td>${Math.round(np)}</td><td style="color:purple;font-weight:bold;">${Math.round(op)}</td><td style="font-weight:800;">‚Ç™${Math.round(np+op)}</td><td><button onclick="deleteItem('${date}')" style="color:#ccc;border:none;background:none;font-size:1.2rem;">‚úï</button></td></tr>`;
            }
        });
        document.getElementById('totalHDisplay').innerText = sumH.toFixed(2) + " ‡∏ä‡∏°.";
        document.getElementById('grossDisplay').innerText = "‚Ç™" + Math.round(totalGross + bonus).toLocaleString();
        document.getElementById('netDisplay').innerText = Math.round(totalGross + bonus - deduct).toLocaleString();
        localStorage.setItem('work_data_v2', JSON.stringify(workData));
    }

    function backupData() {
        navigator.clipboard.writeText(JSON.stringify(workData)).then(() => alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß! ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ Note ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢"));
    }

    function restoreData() {
        const data = prompt("‡∏ß‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô:");
        if (data) { try { workData = JSON.parse(data); renderData(); alert("‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"); } catch(e) { alert("‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"); } }
    }

    function copySummary() {
        const msg = `üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${document.getElementById('monthFilter').value}\n‚è±Ô∏è ‡∏ä‡∏°.‡∏£‡∏ß‡∏°: ${document.getElementById('totalHDisplay').innerText}\nüí∞ ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ‚Ç™${document.getElementById('netDisplay').innerText}`;
        navigator.clipboard.writeText(msg).then(() => alert("‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡πÅ‡∏•‡πâ‡∏ß!"));
    }

    function startWork() {
        startTime = new Date();
        document.getElementById('startBtn').style.display = 'none';
        document.getElementById('endBtn').style.display = 'block';
        timerInterval = setInterval(() => {
            const diff = new Date() - startTime;
            const h = Math.floor(diff/3600000).toString().padStart(2,'0');
            const m = Math.floor((diff%3600000)/60000).toString().padStart(2,'0');
            const s = Math.floor((diff%60000)/1000).toString().padStart(2,'0');
            document.getElementById('timerDisplay').innerText = `${h}:${m}:${s}`;
        }, 1000);
    }

    function endWork() {
        if(!confirm("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô? (‡∏´‡∏±‡∏Å‡∏û‡∏±‡∏Å 30‡∏ô.)")) return;
        const diff = (new Date() - startTime) / 3600000;
        const final = diff > 0.5 ? diff - 0.5 : diff;
        workData[document.getElementById('currentDate').value] = (parseFloat(workData[document.getElementById('currentDate').value] || 0) + final).toFixed(2);
        clearInterval(timerInterval);
        location.reload();
    }

    function saveManual() {
        const d = document.getElementById('manualDate').value;
        const s = new Date(d.replace(/-/g, '/') + ' ' + document.getElementById('timeIn').value);
        let e = new Date(d.replace(/-/g, '/') + ' ' + document.getElementById('timeOut').value);
        if (e <= s) e.setDate(e.getDate() + 1);
        const diff = (e - s) / 3600000 - parseFloat(document.getElementById('manualBreak').value);
        if(diff > 0) { workData[d] = (parseFloat(workData[d] || 0) + diff).toFixed(2); renderData(); alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"); }
    }

    function deleteItem(d) { if(confirm('‡∏•‡∏ö?')) { delete workData[d]; renderData(); } }
    function clearSystem() { if(confirm('‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) { localStorage.clear(); location.reload(); } }
    renderData();
</script>
</body>
</html>
